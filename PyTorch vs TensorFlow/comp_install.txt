1. Install gpu driver
https://www.nvidia.com/download/index.aspx

ex: for A2000 => driver version 516.59

2. Install cuda toolkit for WSL-Ubuntu, deb (local):
https://developer.nvidia.com/cuda-downloads
In my case cu118 worked (https://developer.nvidia.com/cuda-11-8-0-download-archive) for both frameworks.

same ex:
wget https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin
sudo mv cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-600
wget https://developer.download.nvidia.com/compute/cuda/12.3.0/local_installers/cuda-repo-wsl-ubuntu-12-3-local_12.3.0-1_amd64.deb
sudo dpkg -i cuda-repo-wsl-ubuntu-12-3-local_12.3.0-1_amd64.deb
sudo cp /var/cuda-repo-wsl-ubuntu-12-3-local/cuda-*-keyring.gpg /usr/share/keyrings/
sudo apt-get update
sudo apt-get -y install cuda-toolkit-12-3

3. Install WSL
wsl --list --online
ex: wsl --install -d Ubuntu-22.04

4. Under Ubuntu:
sudo apt install python3 python3-pip ipython3 python3.10-venv
python3.10 -m venv pt_ws
source pt_ws/bin/activate

5. Install TensorFlow and PyTorch with CUDA support
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
python3 -m pip install tensorflow[and-cuda]

6. Test installation
python -c "import tensorflow as tf; import torch as th; print(tf.config.list_physical_devices('GPU'), th.cuda.is_available())"
python -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"

7. Other libraries:
pip install pandas
pip install matplotlib
pip install notebook
pip install cupy-cuda11x

8. Install venv to be used in jupyter:
python -m ipykernel install --user --name pt_ws